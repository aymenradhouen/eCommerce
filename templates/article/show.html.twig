{% extends 'base.html.twig' %}

{% block title %}Article Information{% endblock %}
{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('css/shop-item.css') }}" rel="stylesheet">
    <link href="{{ asset('bootstrap/css/bootstrap.min.css') }}" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

{% endblock %}

{% block body %}

    {% for article in articles %}

    <div class="container">
        <section class="jumbotron">
            <div class="container">
                <h1 class="jumbotron-heading">Categorie : {{ article.categorie }}</h1>
            </div>
        </section>
        <div class="row">
            <div class="col-12 col-lg-6">
                <div class="card bg-light mb-3">
                    <div class="card-body">
                        <a href="" data-toggle="modal" data-target="#productModal">
                            <img class="img-fluid" style="height: 500px; width: 500px;" src="/uploads/{{ article.image }}" alt="Image" />
                            <p class="text-center">Zoom</p>
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-12 col-lg-6 add_to_cart_block">
                <div class="card bg-light mb-3">
                    <div class="card-body">
                        <p style="text-align: center;font-weight: bold;font-size: 200%;">{{ article.nom }}</p>
                        <p class="price" style="color: #c01508; text-align: center;font-weight: bold;font-size: 150%; margin-bottom: 0;">{{ article.prix }} $</p>
                        <div style="display: inline-block;
    font-size: 14px;
    font-weight: 500;
    color: #6c6a74;">Availability:</div>
                        {% if article.quantite > 0 %}
                            <span style="display: inline-block;
    font-size: 14px;
    font-weight: 500;
    color: #44a038;
    margin-left: 5px;"
                            >In Stock</span>
                            {% else %}
                                <span style="display: inline-block;
    font-size: 14px;
    font-weight: 500;
    color: red;
    margin-left: 5px;"
                                >Sold Out</span>
                        {% endif %}
                        <form method="POST" action="{{ path('panier_add', {id : article.id}) }}" name="myForm">
                            <div class="form-group">
                                <label>Quantity :</label>
                                <div class="input-group mb-3">
                                    <input type="number" class="form-control" id="quantity" name="quantity" min="1" max="{{ article.quantite }}" value="1">
                                </div>
                            </div>
                            {% if article.quantite > 0 %}
                            <button type="submit" class="btn btn-success btn-lg btn-block text-uppercase"><i class="fa fa-shopping-cart"></i> Add To Cart
                            </button>
                            {% else %}
                                <button type="submit" class="btn btn-success btn-lg btn-block text-uppercase" disabled><i class="fa fa-shopping-cart"></i> Add To Cart
                                </button>
                                {% endif %}

                        </form>
                        <div class="reviews_product p-3 mb-2 ">
                            {{ article.reviews | length }} reviews
                            <a class="pull-right" href="#reviews">View all reviews</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card border-light mb-3">
                    <div class="card-header bg-primary text-white text-uppercase"><i class="fa fa-align-justify"></i> Description</div>
                    <div class="card-body">
                        <p class="card-text">
                            {{ article.description  }}
                        </p>
                    </div>
                </div>
            </div>

            <div class="col-12" id="reviews">
                <div class="card border-light mb-3">
                    <div class="card-header bg-primary text-white text-uppercase"><i class="fa fa-comment"></i> Reviews</div>
                    <div class="card-body">
    {% for review in article.reviews %}
                        <div class="review">
                            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                            {% if review.username == app.user.loginName %}
                                <a style="float: right;" href="{{ path('review_remove', {id : review.id}) }}" class="btn btn-danger btn-sm">
                                    <i class="fa fa-trash"></i>
                                </a>
                            {% endif %}
                            {% endif %}
                            <meta itemprop="datePublished" content="01-01-2016">{{ review.createdAt|date('Y-m-d H:i:s') }}
                            by {{ review.username }}
                            <p class="blockquote">
                            <p class="mb-0">{{ review.content }}</p>
                            <hr>
                        </div>
    {% endfor %}
        {{ form_start(reviews) }}
        {{ form_row(reviews.content,  {'label' : 'Review','attr' : {'placeholder' : "Review",'class' : 'form-control'}}) }}
        <button type="submit" class="btn btn-success">Leave a Review</button>
        {{ form_end(reviews) }}
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="productModal" tabindex="-1" role="dialog" aria-labelledby="productModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="productModalLabel">{{ article.nom }}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">Ã—</span>
                    </button>
                </div>
                <div class="modal-body">
                    <img class="img-fluid" style="height: 500px; width: 500px;" src="/uploads/{{ article.image }}" alt="Image" />
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}





{% endblock %}

{% block javascripts %}
    <script src="{{ asset('js/jquery.min.js') }}"></script>
    <script src="{{ asset('js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ asset('js/shop.js') }}"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
{% endblock %}
